import React, { useEffect, useRef } from 'react';
import { Link } from 'react-router-dom';
import { Container, Row, Col, Card, Button, Badge } from 'react-bootstrap';
import { motion, useAnimation, AnimatePresence } from 'framer-motion';
import { useInView } from 'react-intersection-observer';
import { Parallax } from 'react-scroll-parallax';
import { 
  FaShieldAlt, 
  FaBrain, 
  FaClipboardCheck, 
  FaTractor, 
  FaChartLine, 
  FaMobileAlt, 
  FaSync, 
  FaStar, 
  FaCheckCircle,
  FaPhoneAlt,
  FaPlayCircle,
  FaLeaf,
  FaSeedling,
  FaCloudSun,
  FaDollarSign,
  FaUsers,
  FaCog,
  FaArrowRight,
  FaChartPie,
  FaUserShield,
  FaTools,
  FaChartBar,
  FaRegLightbulb,
  FaRegClock,
  FaRegChartBar,
  FaRegSmile
} from 'react-icons/fa';
import { useInView } from 'react-intersection-observer';
import { Parallax } from 'react-scroll-parallax';
import './Home.css';

const Home = () => {
  const features = [
    {
      icon: <FaShieldAlt className="feature-icon" />,
      title: "Biosecurity Management",
      description: "Implement and monitor comprehensive biosecurity measures to protect your livestock."
    },
    {
      icon: <FaBrain className="feature-icon" />,
      title: "AI-Powered Insights",
      description: "Get intelligent recommendations and predictive analytics for better decision making."
    },
    {
      icon: <FaClipboardCheck className="feature-icon" />,
      title: "Inspection Tracking",
      description: "Schedule and track farm inspections with automated compliance reporting."
    },
    {
      icon: <FaTractor className="feature-icon" />,
      title: "Farm Operations",
      description: "Manage all aspects of your farm operations from a single, intuitive platform."
    },
    {
      icon: <FaChartLine className="feature-icon" />,
      title: "Analytics Dashboard",
      description: "Track performance metrics and gain valuable insights into your farm's productivity."
    },
    {
      icon: <FaMobileAlt className="feature-icon" />,
      title: "Mobile Access",
      description: "Access your farm data anytime, anywhere with our mobile-friendly platform."
    }
  ];

  const testimonials = [
    {
      quote: "FarmFist has transformed how we manage our poultry farm. The biosecurity features are exceptional!",
      author: "John D., Poultry Farmer",
      rating: 5
    },
    {
      quote: "The AI insights helped us reduce feed costs by 15% while maintaining optimal livestock health.",
      author: "Sarah M., Livestock Manager",
      rating: 5
    },
    {
      quote: "Easy to use and has everything we need to manage our farm operations efficiently.",
      author: "Robert K., Farm Owner",
      rating: 5
    }
  ];

  const steps = [
    {
      number: '01',
      title: 'Sign Up & Setup',
      description: 'Create your account and set up your farm profile in minutes.',
      icon: <FaClipboardCheck className="text-primary" />
    },
    {
      number: '02',
      title: 'Connect Your Farm',
      description: 'Integrate with your existing farm equipment and data sources.',
      icon: <FaSync className="text-primary" />
    },
    {
      number: '03',
      title: 'Start Managing',
      description: 'Access real-time insights and manage your operations from anywhere.',
      icon: <FaChartLine className="text-primary" />
    }
  ];

  const farmTypes = [
    {
      title: 'Livestock Farms',
      icon: <FaTractor className="text-primary mb-3" size={40} />,
      features: ['Herd Management', 'Health Tracking', 'Feed Management']
    },
    {
      title: 'Crop Farms',
      icon: <FaSeedling className="text-success mb-3" size={40} />,
      features: ['Field Monitoring', 'Irrigation Control', 'Harvest Planning']
    },
    {
      title: 'Mixed Farming',
      icon: <FaLeaf className="text-warning mb-3" size={40} />,
      features: ['Integrated Systems', 'Resource Optimization', 'Diversified Income']
    }
  ];

  // Animation hooks
  const controls = useAnimation();
  const [ref, inView] = useInView({
    threshold: 0.1,
    triggerOnce: true
  });

  useEffect(() => {
    if (inView) {
      controls.start('visible');
    }
  }, [controls, inView]);

  const containerVariants = {
    hidden: { opacity: 0 },
    visible: {
      opacity: 1,
      transition: {
        staggerChildren: 0.1
      }
    }
  };

  const itemVariants = {
    hidden: { y: 20, opacity: 0 },
    visible: {
      y: 0,
      opacity: 1,
      transition: {
        type: 'spring',
        stiffness: 100,
        damping: 10
      }
    }
  };

  // Animation variants
  const container = {
    hidden: { opacity: 0 },
    show: {
      opacity: 1,
      transition: {
        staggerChildren: 0.1
      }
    }
  };

  const item = {
    hidden: { opacity: 0, y: 20 },
    show: { 
      opacity: 1, 
      y: 0,
      transition: {
        type: 'spring',
        stiffness: 100,
        damping: 10
      }
    }
  };

  return (
    <div className="home-page">
      {/* Animated Background Elements */}
      <div className="floating-elements">
        {[...Array(12)].map((_, i) => {
          const size = 20 + Math.random() * 20;
          const delay = Math.random() * 5;
          const duration = 10 + Math.random() * 20;
          const posX = Math.random() * 100;
          const posY = Math.random() * 100;
          
          return (
            <motion.div 
              key={i}
              className="floating-element"
              style={{
                position: 'absolute',
                left: `${posX}%`,
                top: `${posY}%`,
                width: `${size}px`,
                height: `${size}px`,
                color: `rgba(79, 70, 229, ${0.1 + Math.random() * 0.2})`,
                zIndex: 0
              }}
              animate={{
                y: [0, -100, -200],
                x: [0, Math.random() * 100 - 50, Math.random() * 100 - 50],
                opacity: [0, 1, 0],
                rotate: [0, 360]
              }}
              transition={{
                duration: duration,
                repeat: Infinity,
                repeatType: 'loop',
                delay: delay,
                ease: 'linear'
              }}
            >
              {i % 6 === 0 ? <FaLeaf /> : 
               i % 6 === 1 ? <FaSeedling /> : 
               i % 6 === 2 ? <FaTractor /> : 
               i % 6 === 3 ? <FaCloudSun /> : 
               i % 6 === 4 ? <FaChartPie /> : <FaChartBar />}
            </motion.div>
          );
        })}
      </div>

      {/* Hero Section */}
      <section className="hero-section position-relative overflow-hidden py-8 py-lg-10" ref={ref}>
        <div className="position-absolute top-0 start-0 w-100 h-100 bg-pattern"></div>
        <Container className="position-relative z-2">
          <Row className="align-items-center min-vh-80">
            <Col lg={6} className="mb-8 mb-lg-0">
              <motion.div 
                className="hero-content"
                initial="hidden"
                animate={controls}
                variants={container}
              >
                <motion.div variants={item} className="mb-4">
                  <Badge 
                    className="px-4 py-2 rounded-pill d-inline-flex align-items-center glass border-0"
                    style={{
                      background: 'rgba(255, 255, 255, 0.7)',
                      backdropFilter: 'blur(10px)',
                      color: 'var(--primary)',
                      border: '1px solid rgba(79, 70, 229, 0.1)'
                    }}
                  >
                    <FaSync className="me-2" /> Now with AI-Powered Analytics
                  </Badge>
                </motion.div>
                
                <motion.h1 className="display-3 fw-800 mb-4 text-dark" variants={item}>
                  Smart Farming <br />
                  <span className="text-gradient-primary">Reimagined</span> with FarmFist
                </motion.h1>
                
                <motion.p className="lead mb-6 text-muted" variants={item} style={{maxWidth: '90%'}}>
                  Transform your agricultural operations with our comprehensive digital platform. 
                  Streamline livestock management, crop monitoring, and resource allocation while 
                  ensuring the highest standards of biosecurity and sustainability.
                </motion.p>
                
                <motion.div className="d-flex flex-wrap gap-4 mb-6" variants={item}>
                  <Link to="/register" className="text-decoration-none">
                    <motion.div
                      whileHover={{ y: -2 }}
                      whileTap={{ scale: 0.98 }}
                      className="position-relative"
                    >
                      <Button 
                        variant="primary" 
                        size="lg" 
                        className="px-6 py-3 fw-bold border-0 shadow-sm"
                        style={{
                          background: 'linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%)',
                          minWidth: '220px',
                          position: 'relative',
                          overflow: 'hidden'
                        }}
                      >
                        <span className="position-relative z-2 d-flex align-items-center justify-content-center">
                          <FaTractor className="me-2" /> Get Started Free
                        </span>
                        <motion.span 
                          className="button-hover-effect"
                          initial={{ x: '-100%' }}
                          whileHover={{ x: '100%' }}
                          transition={{ duration: 0.6, ease: 'easeInOut' }}
                          style={{
                            position: 'absolute',
                            top: 0,
                            left: 0,
                            width: '100%',
                            height: '100%',
                            background: 'linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent)'
                          }}
                        />
                      </Button>
                    </motion.div>
                  </Link>
                  
                  <Link to="/features" className="text-decoration-none">
                    <motion.div
                      whileHover={{ y: -2 }}
                      whileTap={{ scale: 0.98 }}
                    >
                      <Button 
                        variant="outline-primary" 
                        size="lg" 
                        className="px-5 py-3 fw-bold d-flex align-items-center"
                        style={{
                          borderColor: 'var(--primary)',
                          color: 'var(--primary)',
                          minWidth: '180px',
                          background: 'rgba(255, 255, 255, 0.7)',
                          backdropFilter: 'blur(10px)'
                        }}
                      >
                        Learn More <FaArrowRight className="ms-2" />
                      </Button>
                    </motion.div>
                  </Link>
                </motion.div>
                
                <motion.div className="d-flex flex-wrap align-items-center gap-3" variants={item}>
                  <div className="d-flex">
                    {[...Array(5)].map((_, i) => (
                      <FaStar 
                        key={i} 
                        className="text-warning me-1" 
                        style={{ 
                          fontSize: '1.1rem',
                          filter: 'drop-shadow(0 2px 4px rgba(245, 158, 11, 0.3))'
                        }} 
                      />
                    ))}
                  </div>
                  <div className="d-flex flex-wrap gap-2 text-muted" style={{ fontSize: '0.95rem' }}>
                    <span className="d-flex align-items-center">
                      <span className="fw-600 text-dark me-1">4.9/5</span> by 1000+ farmers
                    </span>
                    <span className="d-none d-md-inline">â€¢</span>
                    <span className="d-flex align-items-center">
                      <FaCheckCircle className="text-success me-1" size={14} /> No credit card required
                    </span>
                  </div>
                </motion.div>
              </motion.div>
            </Col>
            
            <Col lg={6} className="position-relative">
              <Parallax speed={-5}>
                <motion.div 
                  className="hero-image-container position-relative"
                  initial={{ opacity: 0, y: 50 }}
                  animate={{ 
                    opacity: 1, 
                    y: 0,
                    transition: { 
                      delay: 0.3,
                      type: 'spring',
                      stiffness: 100,
                      damping: 15
                    } 
                  }}
                  whileHover={{ y: -10 }}
                >
                  <div className="position-relative z-2">
                    <img 
                      src="/images/dashboard-preview.svg" 
                      alt="FarmFist Dashboard Preview" 
                      className="img-fluid rounded-4 shadow-lg w-100"
                      style={{
                        border: '1px solid rgba(255, 255, 255, 0.5)',
                        boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.15)',
                        backdropFilter: 'blur(20px)',
                        background: 'rgba(255, 255, 255, 0.7)'
                      }}
                      onError={(e) => {
                        e.target.style.display = 'none';
                        const fallback = e.target.nextElementSibling;
                        if (fallback) fallback.style.display = 'block';
                      }}
                    />
                  </div>
                  
                  {/* Decorative elements */}
                  <div className="position-absolute top-0 start-0 w-100 h-100" style={{ zIndex: 1 }}>
                    <div className="position-absolute" style={{ top: '10%', left: '-5%', width: '120px', height: '120px', borderRadius: '50%', background: 'radial-gradient(circle, rgba(16, 185, 129, 0.1) 0%, transparent 70%)' }}></div>
                    <div className="position-absolute" style={{ bottom: '10%', right: '-5%', width: '150px', height: '150px', borderRadius: '50%', background: 'radial-gradient(circle, rgba(79, 70, 229, 0.1) 0%, transparent 70%)' }}></div>
                  </div>
                </motion.div>
              </Parallax>
              <div className="dashboard-preview-fallback" style={{ display: 'none' }}>
                    <svg width="100%" height="auto" viewBox="0 0 800 500" xmlns="http://www.w3.org/2000/svg">
                      <rect width="800" height="500" fill="#f8f9fa" rx="8"/>
                      <rect x="20" y="20" width="760" height="60" rx="4" fill="#fff" stroke="#e9ecef" strokeWidth="1"/>
                      <rect x="20" y="100" width="200" height="380" rx="4" fill="#fff" stroke="#e9ecef" strokeWidth="1"/>
                      <rect x="240" y="100" width="540" height="200" rx="4" fill="#fff" stroke="#e9ecef" strokeWidth="1"/>
                      <rect x="240" y="320" width="170" height="160" rx="4" fill="rgba(13, 110, 253, 0.1)" stroke="rgba(13, 110, 253, 0.2)" strokeWidth="1"/>
                      <rect x="430" y="320" width="170" height="160" rx="4" fill="rgba(25, 135, 84, 0.1)" stroke="rgba(25, 135, 84, 0.2)" strokeWidth="1"/>
                      <rect x="620" y="320" width="160" height="160" rx="4" fill="rgba(111, 66, 193, 0.1)" stroke="rgba(111, 66, 193, 0.2)" strokeWidth="1"/>
                      <text x="40" y="55" fontFamily="Arial" fontSize="16" fontWeight="bold" fill="#212529">FarmFist Dashboard</text>
                      <text x="40" y="135" fontFamily="Arial" fontSize="14" fill="#495057">Dashboard</text>
                      <text x="40" y="165" fontFamily="Arial" fontSize="14" fill="#495057">Livestock</text>
                      <text x="40" y="195" fontFamily="Arial" fontSize="14" fill="#495057">Crops</text>
                      <text x="40" y="225" fontFamily="Arial" fontSize="14" fill="#495057">Inventory</text>
                      <text x="40" y="255" fontFamily="Arial" fontSize="14" fill="#495057">Reports</text>
                      <text x="40" y="285" fontFamily="Arial" fontSize="14" fill="#495057">Settings</text>
                      <text x="260" y="135" fontFamily="Arial" fontSize="18" fontWeight="bold" fill="#212529">Farm Overview</text>
                      <rect x="260" y="160" width="500" height="120" rx="4" fill="#f8f9fa" stroke="#e9ecef" strokeWidth="1"/>
                      <text x="270" y="350" fontFamily="Arial" fontSize="14" fontWeight="bold" fill="#0d6efd">Total Livestock</text>
                      <text x="270" y="380" fontFamily="Arial" fontSize="24" fontWeight="bold" fill="#0d6efd">1,248</text>
                      <text x="460" y="350" fontFamily="Arial" fontSize="14" fontWeight="bold" fill="#198754">Healthy Animals</text>
                      <text x="460" y="380" fontFamily="Arial" fontSize="24" fontWeight="bold" fill="#198754">1,198</text>
                      <text x="650" y="350" fontFamily="Arial" fontSize="14" fontWeight="bold" fill="#6f42c1">Alerts</text>
                      <text x="650" y="380" fontFamily="Arial" fontSize="24" fontWeight="bold" fill="#6f42c1">3</text>
                    </svg>
                  </div>
                  <div className="floating-badge bg-primary text-white">
                    <FaShieldAlt className="me-2" />
                    <span>Live Biosecurity Alerts</span>
                  </div>
                </div>
              </div>
            </Col>
          </Row>
        </Container>
      </section>

      {/* Features Section */}
      <section className="py-5 bg-light">
        <Container className="py-5">
          <Row className="text-center mb-5">
            <Col lg={8} className="mx-auto">
              <h2 className="display-5 fw-bold mb-3">Everything You Need to Succeed</h2>
              <p className="lead text-muted">FarmFist provides a complete suite of tools designed specifically for modern farming operations</p>
            </Col>
          </Row>
          <Row className="g-4">
            {features.map((feature, index) => (
              <Col md={6} lg={4} key={index}>
                <div className="feature-card h-100 p-4 bg-white rounded-3 shadow-sm">
                  <div className="feature-icon-container mb-4">
                    {feature.icon}
                  </div>
                  <h4 className="h5 fw-bold mb-3">{feature.title}</h4>
                  <p className="text-muted mb-0">{feature.description}</p>
                </div>
              </Col>
            ))}
          </Row>
        </Container>
      </section>

      {/* How It Works Section */}
      <section className="py-5">
        <Container className="py-5">
          <Row className="text-center mb-5">
            <Col lg={8} className="mx-auto">
              <h2 className="display-5 fw-bold mb-3">How FarmFist Works</h2>
              <p className="lead text-muted">Get started in three simple steps and transform your farming operations</p>
            </Col>
          </Row>
          <Row className="g-4">
            {steps.map((step, index) => (
              <Col md={4} key={index}>
                <div className="h-100 p-4 text-center">
                  <div className="position-relative mb-4">
                    <div className="d-inline-flex align-items-center justify-content-center rounded-circle bg-primary bg-opacity-10" style={{width: '80px', height: '80px'}}>
                      {step.icon}
                    </div>
                    <span className="position-absolute top-0 start-50 translate-middle badge rounded-pill bg-primary">
                      {step.number}
                    </span>
                  </div>
                  <h4 className="h5 fw-bold mb-3">{step.title}</h4>
                  <p className="text-muted mb-0">{step.description}</p>
                </div>
              </Col>
            ))}
          </Row>
        </Container>
      </section>

      {/* Farm Types Section */}
      <section className="py-5 bg-light">
        <Container className="py-5">
          <Row className="text-center mb-5">
            <Col lg={8} className="mx-auto">
              <h2 className="display-5 fw-bold mb-3">Perfect for All Farm Types</h2>
              <p className="lead text-muted">Tailored solutions for different agricultural operations</p>
            </Col>
          </Row>
          <Row className="g-4">
            {farmTypes.map((type, index) => (
              <Col md={4} key={index}>
                <div className="h-100 p-4 text-center bg-white rounded-3 shadow-sm">
                  {type.icon}
                  <h4 className="h5 fw-bold mb-3">{type.title}</h4>
                  <ul className="list-unstyled">
                    {type.features.map((feature, i) => (
                      <li key={i} className="mb-2">
                        <FaCheckCircle className="text-success me-2" />
                        {feature}
                      </li>
                    ))}
                  </ul>
                </div>
              </Col>
            ))}
          </Row>
        </Container>
      </section>

      {/* Stats Section */}
      <section className="py-5 bg-primary text-white">
        <Container className="py-5">
          <Row className="text-center">
            <Col md={3} className="mb-4 mb-md-0">
              <div className="stat-item p-4">
                <div className="display-3 fw-bold">95%</div>
                <p className="mb-0">Disease Prevention</p>
              </div>
            </Col>
            <Col md={3} className="mb-4 mb-md-0">
              <div className="stat-item p-4">
                <div className="display-3 fw-bold">24/7</div>
                <p className="mb-0">Monitoring</p>
              </div>
            </Col>
            <Col md={3} className="mb-4 mb-md-0">
              <div className="stat-item p-4">
                <div className="display-3 fw-bold">1000+</div>
                <p className="mb-0">Happy Farmers</p>
              </div>
            </Col>
            <Col md={3}>
              <div className="stat-item p-4">
                <div className="display-3 fw-bold">99.9%</div>
                <p className="mb-0">Uptime</p>
              </div>
            </Col>
          </Row>
        </Container>
      </section>

      {/* Testimonials Section */}
      <section className="py-5">
        <Container className="py-5">
          <Row className="text-center mb-5">
            <Col lg={8} className="mx-auto">
              <h2 className="display-5 fw-bold mb-3">What Farmers Are Saying</h2>
              <p className="lead text-muted">Join thousands of successful farmers who trust FarmFist</p>
            </Col>
          </Row>
          <Row>
            <Col lg={10} className="mx-auto">
              <Carousel indicators={false}>
                {testimonials.map((testimonial, index) => (
                  <Carousel.Item key={index}>
                    <div className="text-center px-5">
                      <div className="d-flex justify-content-center mb-4">
                        {[...Array(5)].map((_, i) => (
                          <FaStar key={i} className="text-warning mx-1" />
                        ))}
                      </div>
                      <p className="lead mb-4">"{testimonial.quote}"</p>
                      <p className="text-muted fw-bold">{testimonial.author}</p>
                    </div>
                  </Carousel.Item>
                ))}
              </Carousel>
            </Col>
          </Row>
        </Container>
      </section>

      {/* CTA Section */}
      <section className="py-5 bg-dark text-white">
        <Container className="py-5 text-center">
          <h2 className="display-5 fw-bold mb-4">Ready to Transform Your Farm?</h2>
          <p className="lead mb-4">Join thousands of farmers who are already improving their operations with FarmFist</p>
          <div className="d-flex justify-content-center gap-3">
            <Button variant="primary" size="lg" className="px-4">Start Free Trial</Button>
            <Button variant="outline-light" size="lg" className="px-4">
              <FaPhoneAlt className="me-2" /> Contact Us
            </Button>
          </div>
        </Container>
      </section>
    </div>
  );
};

export default Home;